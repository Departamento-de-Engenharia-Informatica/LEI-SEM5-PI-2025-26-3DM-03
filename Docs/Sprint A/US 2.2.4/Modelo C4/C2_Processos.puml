@startuml C2_Manage_Storage_Areas_Process_View
title C2 – Manage Storage Areas (Process View – Create Storage Area)

actor "Port Authority Officer" as Officer
participant "Frontend Web Application\n(React / Angular)" as Frontend
participant "Storage Areas Management API\n(ASP.NET Core Web API)" as API
participant "External IAM Provider\n(SSO / OAuth 2.0)" as IAM
database "PLMS Database\n(SQL / EF Core)" as DB

Officer -> Frontend : Login (Credenciais)
Frontend -> IAM : Solicita token de autenticação
IAM --> Frontend : Retorna Access Token (JWT)

Officer -> Frontend : Submete formulário (novo storage area)
Frontend -> API : POST /api/StorageAreas (JSON + Token JWT)
API -> IAM : Valida Token (OAuth 2.0)
IAM --> API : Token válido

API -> DB : INSERT INTO StorageAreas (...)
DB --> API : Confirma inserção (OK)

API --> Frontend : HTTP 201 Created + StorageAreaDTO
Frontend --> Officer : Mostra confirmação e novo storage area

@enduml

  Service -> AreaRepo: UpdateAsync(area)
  AreaRepo -> DB: UPDATE
  Controller --> Officer: 200 OK (DTO)
end

== Search ==
Officer -> Controller: GET /api/StorageAreas?type&location&servedDockId
Controller -> Service: GetAllStorageAreasAsync()
Service -> AreaRepo: GetAllAsync(filters)
AreaRepo -> DB: SELECT + WHERE (type/location/servedDockId)
DB --> AreaRepo --> Service --> Controller --> Officer: 200 OK [DTO...]
@enduml
