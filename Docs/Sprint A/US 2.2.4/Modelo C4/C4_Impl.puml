@startuml C4_Manage_Storage_Areas_Implementation_View
title C4 – Manage Storage Areas (Code / Class Implementation View)

skinparam class {
  BackgroundColor HoneyDew
  BorderColor Black
  FontColor Black
}

skinparam package {
  BackgroundColor White
  BorderColor Black
  FontStyle bold
}

package "TodoApi.Controllers.StorageAreas" {
  class StorageAreasController {
    -PortContext _context
    +GetStorageAreas()
    +GetStorageArea(id)
    +PostStorageArea(CreateStorageAreaDTO)
    +PutStorageArea(id, UpdateStorageAreaDTO)
    +DeleteStorageArea(id)
  }
}

package "TodoApi.Models.StorageAreas" {
  class StorageArea {
    +int Id <<PK>>
    +string Type
    +string Location
    +int MaxCapacityTEU
    +int CurrentOccupancyTEU
    +List<int> ServedDockIds
    +Dictionary<int, decimal> DockDistances
  }
  
  class StorageAreaDTO {
    +int Id
    +string Type
    +string Location
    +int MaxCapacityTEU
    +int CurrentOccupancyTEU
    +List<int> ServedDockIds
    +Dictionary<int, decimal> DockDistances
  }
  
  class CreateStorageAreaDTO {
    +string Type
    +string Location
    +int MaxCapacityTEU
    +int CurrentOccupancyTEU
    +List<int> ServedDockIds
    +Dictionary<int, decimal> DockDistances
  }
  
  class UpdateStorageAreaDTO {
    +int Id
    +string Type
    +string Location
    +int MaxCapacityTEU
    +int CurrentOccupancyTEU
    +List<int> ServedDockIds
    +Dictionary<int, decimal> DockDistances
  }
  
  class StorageAreaMapper {
    +{static} ToDTO(StorageArea): StorageAreaDTO
    +{static} ToEntity(CreateStorageAreaDTO): StorageArea
    +{static} UpdateEntity(StorageArea, UpdateStorageAreaDTO)
    +{static} ValidateCapacity(StorageArea): bool
  }
}

package "TodoApi.Models" {
  class PortContext {
    +DbSet<StorageArea> StorageAreas
    +DbSet<Dock> Docks
    +SaveChangesAsync()
  }
}

StorageAreasController --> PortContext
StorageAreasController --> StorageAreaMapper
StorageAreaMapper --> StorageArea
StorageAreaMapper --> StorageAreaDTO
StorageAreaMapper --> CreateStorageAreaDTO
StorageAreaMapper --> UpdateStorageAreaDTO

note right of StorageAreaMapper::ValidateCapacity
  Enforces business rule:
  CurrentOccupancyTEU ≤ MaxCapacityTEU
end note

@enduml

