@startuml C4_Manage_Docks_Process_View
title C4 – Manage Docks (Process View – Create Dock)
hide footbox

actor "Port Authority Officer" as Officer
participant "Frontend Web App\n(React / Angular)" as Frontend
participant "Docks Management API\n(ASP.NET Core)" as API
participant "External IAM Provider\n(OAuth 2.0 / OIDC)" as IAM
database "PLMS Database\n(SQL / InMemory)" as DB

== Autenticação ==
Officer -> Frontend : Inicia sessão (credenciais)
Frontend -> IAM : Solicita Token OAuth 2.0
IAM --> Frontend : Retorna Access Token (JWT)

== Criação de Dock ==
Officer -> Frontend : Submete formulário (dados do novo dock)
Frontend -> API : POST /api/Docks (JSON + Bearer Token)
API -> IAM : Valida token JWT
IAM --> API : Token válido

== Validação e Persistência ==
API -> API : Valida physical characteristics (length, depth, max draft > 0)
API -> API : Valida allowed vessel types (IDs existentes)
alt Validação Falha
  API --> Frontend : HTTP 400 BadRequest
  Frontend --> Officer : Mostra erro (validação)
else Validação OK
  API -> DB : INSERT INTO Docks (...)
  DB --> API : Confirmação (OK)
  
  == Resposta ==
  API --> Frontend : HTTP 201 Created (DockDTO)
  Frontend --> Officer : Mostra confirmação (dock criado)
end

@enduml

