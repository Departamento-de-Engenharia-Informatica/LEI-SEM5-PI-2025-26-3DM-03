@startuml C2_Register_ShippingAgents_Process_View
!include <C4/C4_Container>

title C2 – Register Shipping Agent Organizations (US 2.2.5)

Person(officer, "Port Authority Officer")

System_Boundary(sys, "Port Logistics Management System (PLMS)") {
  Container(api, "Shipping Agents Management API (TodoApi)", "C#", "Handles registration of organizations")
  ContainerDb(db, "PLMS Database", "SQL / EF Core", "ShippingAgents, Representatives; Address (owned)")
}

System_Ext(mail, "Email Gateway", "SMTP / Provider API")
System_Ext(sms, "SMS Gateway", "Provider API (optional)")

Rel(officer, api, "POST /api/ShippingAgents (CreateShippingAgentDTO)", "HTTPS / JSON")
Rel(api, db, "INSERT ShippingAgent + Representatives", "EF Core")
Rel(api, mail, "Send confirmation email", "SMTP / API")
Rel(api, sms, "Send confirmation SMS (optional)", "HTTPS")

note right of api
1) Controller receives CreateShippingAgentDTO  
2) (Service) Validates required fields:  
   • TaxNumber > 0 and unique  
   • LegalName and AlternativeName  
   • Complete Address (Street, City, PostalCode, Country)  
   • ≥ 1 Representative with (Name, CitizenID, Nationality, Email, PhoneNumber)  
3) (Service) Maps → domain (ShippingAgent + Representatives)  
4) (Repository) AddAsync + SaveChangesAsync (EF Core)  
5) (API) Sends notification (email / SMS)  
6) Returns 201 Created (ShippingAgentDTO)
end note
@enduml
