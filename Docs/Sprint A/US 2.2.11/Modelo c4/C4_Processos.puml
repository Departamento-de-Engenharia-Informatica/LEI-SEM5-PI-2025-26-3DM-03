@startuml C4_Manage_Operating_Staff_Logical_View
title C4 — Código | Vista Lógica — Operating Staff Management API (componentes/classes)
left to right direction
hide empty members

skinparam package { 
  BackgroundColor White;
  BorderColor Black; 
  FontColor Black; 
  FontStyle bold;
}
skinparam class { 
  BackgroundColor White; 
  BorderColor Black; 
  FontColor Black;
}

' =======================
' Controllers
' =======================
package "Controllers.Staff" {
  class StaffController {
    + GetStaff(search: string?, filterBy: string?) : Task<ActionResult<IEnumerable<StaffDTO>>>
    + GetStaffMember(mecanographic: string) : Task<ActionResult<StaffDTO>>
    + PostStaff(dto: CreateStaffDTO) : Task<ActionResult<StaffDTO>>
    + PutStaff(mecanographic: string, dto: UpdateStaffDTO) : Task<IActionResult>
    + DeactivateStaff(mecanographic: string) : Task<IActionResult>
  }
}

' =======================
' Application
' =======================
package "Application.Services.Staff" {
  interface IStaffService {
    + GetAllAsync(search: string?, filterBy: string?) : Task<List<StaffDTO>>
    + GetByMecanographicNumberAsync(mecanographicNumber: string) : Task<StaffDTO?>
    + CreateAsync(dto: CreateStaffDTO) : Task<StaffDTO>
    + UpdateAsync(mecanographicNumber: string, dto: UpdateStaffDTO) : Task
    + DeactivateAsync(mecanographicNumber: string) : Task
  }

  class StaffService {
    - _repository : IStaffRepository
    + GetAllAsync(search: string?, filterBy: string?) : Task<List<StaffDTO>>
    + GetByMecanographicNumberAsync(mecanographicNumber: string) : Task<StaffDTO?>
    + CreateAsync(dto: CreateStaffDTO) : Task<StaffDTO>
    + UpdateAsync(mecanographicNumber: string, dto: UpdateStaffDTO) : Task
    + DeactivateAsync(mecanographicNumber: string) : Task
  }
}

package "Application.Mapping" {
  class StaffMapper {
    + ToDTO(model: StaffMember) : StaffDTO
    + ToModel(dto: CreateStaffDTO) : StaffMember
    + UpdateModel(model: StaffMember, dto: UpdateStaffDTO) : void
  }
}

' =======================
' Domain
' =======================
package "Domain.Repositories" {
  interface IStaffRepository {
    + GetAllAsync(search: string?, filterBy: string?) : Task<List<StaffMember>>
    + GetByMecanographicNumberAsync(mecanographicNumber: string) : Task<StaffMember?>
    + AddAsync(staff: StaffMember) : Task
    + UpdateAsync(staff: StaffMember) : Task
    + ExistsAsync(mecanographicNumber: string) : Task<bool>
    + SaveChangesAsync() : Task
  }
}

package "Models.Staff" {
  class StaffMember {
    + MecanographicNumber : string
    + ShortName : string
    + Email : string
    + PhoneNumber : string
    + OperationalWindow : OperationalWindow
    + Status : string
    + Active : bool
    + Qualifications : List<StaffQualification>
  }

  class OperationalWindow <<Value Object>> {
    + StartTime : TimeSpan
    + EndTime : TimeSpan
  }

  class StaffQualification {
    + Id : int
    + QualificationCode : string
  }

  ' — usa classes vazias sem membros fictícios
  class StaffDTO
  class CreateStaffDTO
  class UpdateStaffDTO
}

' =======================
' Infrastructure
' =======================
package "Infrastructure.Repositories" {
  class EfStaffRepository <<implements IStaffRepository>> {
    - _ctx : PortContext
  }
}

package "Data" {
  class PortContext <<DbContext>> {
    + StaffMembers : DbSet<StaffMember>
  }
}

' =======================
' Relações lógicas
' =======================
StaffController --> IStaffService
StaffService -up-|> IStaffService
StaffService --> IStaffRepository
StaffService --> StaffMapper

EfStaffRepository -up-|> IStaffRepository
EfStaffRepository --> PortContext

StaffMapper --> StaffMember
StaffMapper --> StaffDTO
StaffMapper --> CreateStaffDTO
StaffMapper --> UpdateStaffDTO

StaffMember --> OperationalWindow
StaffMember --> StaffQualification
@enduml
