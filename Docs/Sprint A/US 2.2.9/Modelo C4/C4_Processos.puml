@startuml C4_Processos
title C4 — Detailed Sequence (US 2.2.9 – Edit/Complete Vessel Visit Notification)
hide footbox

actor "Shipping Agent Representative" as Rep
participant "VesselVisitNotificationsController" as Controller
participant "VesselVisitNotificationService" as Service
participant "EfVesselVisitNotificationRepository" as Repo
database "PortContext" as Db

== Update Notification ==
Rep -> Controller : PUT /api/VesselVisitNotifications/{id}\n(UpdateVesselVisitNotificationDTO)
activate Controller
Controller -> Service : UpdateAsync(id, dto)
activate Service
Service -> Repo : GetByIdAsync(id)
Repo --> Service : VesselVisitNotification
Service -> Repo : UpdateAsync(entity)
Repo -> Db : SaveChanges()
deactivate Service
Controller --> Rep : 204 No Content

== Submit Notification ==
Rep -> Controller : POST /api/VesselVisitNotifications/{id}/submit
activate Controller
Controller -> Service : SubmitAsync(id, email?, name?)
activate Service
Service -> Repo : GetByIdAsync(id)
Repo --> Service : VesselVisitNotification
Service -> Repo : UpdateAsync(status="Submitted", timestamp)
Repo -> Db : SaveChanges()
deactivate Service
Controller --> Rep : 204 No Content

@enduml