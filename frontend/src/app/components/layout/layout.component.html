<!-- If not authenticated show a simple full-screen login splash with company name -->
<div *ngIf="!isAuthenticated" class="login-splash" style="display:flex;align-items:center;justify-content:center;height:100vh;">
  <div style="text-align:center;max-width:480px;padding:32px;border-radius:8px;">
    <h1 style="margin:0;font-size:28px;color:#02284A;">Port Operations Management</h1>
    <p style="color:#0b5566;margin-top:8px;margin-bottom:24px;">Management console â€” please sign in with your Google account</p>
    <div>
      <button class="btn-primary" (click)="login()" [disabled]="loginInProgress" style="padding:12px 24px;font-size:16px;">
        <span *ngIf="!loginInProgress">{{ i18n.t('login') }}</span>
        <span *ngIf="loginInProgress">{{ i18n.t('login') }}...</span>
      </button>
    </div>
    <div style="margin-top:16px;color:#666;font-size:13px;">
      <small>Use the seeded admin account for local testing.</small>
    </div>
    <div *ngIf="authDeniedReason" style="margin-top:16px;color:#b26b00;">
      <strong>Access denied:</strong> {{ authDeniedReason }}
    </div>
  </div>
</div>

<!-- When authenticated show the full app shell -->
<div *ngIf="isAuthenticated" class="app-shell">
  <header class="app-header" role="banner">
    <div class="header-left">
      <div class="logo" aria-hidden="true">
        <!-- simple svg logo -->
        <svg width="36" height="36" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <rect width="24" height="24" rx="4" fill="#02284A"></rect>
          <path d="M6 15L10 9L14 15" stroke="#0EA5A4" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
        </svg>
      </div>
      <div class="title">{{ title }}</div>
    </div>

    <div class="header-right">
      <div class="lang-switch">
        <button class="lang-btn" (click)="changeLang('en')" [class.active]="lang==='en'">EN</button>
        <button class="lang-btn" (click)="changeLang('pt')" [class.active]="lang==='pt'">PT</button>
      </div>
      <div class="user-area">
        <div class="account-info">
          <div class="account-name">{{ userName || userEmail }}</div>
          <div class="role">{{ (userRole || '-') | uppercase }}</div>
          <div class="user-actions">
            <button class="btn-ghost" (click)="logout()">{{ i18n.t('logout') }}</button>
          </div>
        </div>
      </div>
    </div>
  </header>

  <div class="app-body">
    <aside class="sidebar" role="navigation">
      <nav>
        <ul>
          <li *ngFor="let item of visibleMenu" routerLinkActive="active">
            <a [routerLink]="item.route" class="menu-item">
              <span class="icon" aria-hidden="true"><i [class]="item.icon"></i></span>
              <span class="label">{{ i18n.t('menu.' + item.key) }}</span>
            </a>
          </li>
        </ul>
      </nav>

      <div class="sidebar-footer">
        <small class="muted">{{ lang==='pt' ? 'Ajuda' : 'Help' }}</small>
      </div>
    </aside>

    <main class="main-content" role="main">
      <div *ngIf="authDeniedReason" class="auth-denied">
        <div class="alert alert-warning">
          {{ 'Access denied:' }}
          <strong>{{ authDeniedReason }}</strong>
          <div *ngIf="!isAuthenticated">{{ 'Please contact the administrator.' }}</div>
        </div>
      </div>
      <div class="breadcrumbs" aria-hidden="true">{{ i18n.t('home') }} / <span class="muted">{{ i18n.t('breadcrumb.dashboard') }}</span></div>

      <!-- app content goes here -->
      <router-outlet></router-outlet>

      <footer class="app-footer"></footer>
    </main>
  </div>
</div>
